{# SwagCinemaTheme Copyright (C) 2025 shopware AG #}

{# @deprecated tag:v4.0.0 - File will be removed as it is not extending the Product detail page properly. Extend the CMS block templates instead. #}
{% sw_extends '@Storefront/storefront/page/product-detail/buy-widget-form.html.twig' %}

{% block page_product_detail_buy_container %}
    {% if buyable %}
        <div class="row g-2 buy-widget-container">
            {% block page_product_detail_buy_quantity_container %}
                <div class="col-12 product-detail-quantity-box {% if page.product.calculatedPrices|length <= 1 %}product-detail-quantity-box--column{% endif %}">
                    {% if showQuantitySelect %}
                        <div class="product-detail-buy-quantity">
                            {% set selectQuantityThreshold = 100 %}
                            {{ block('page_product_detail_buy_quantity') }}

                            {% block page_product_detail_tax %}
                                {# the block page_product_detail_tax was moved from product-detail/buy-widget.html.twig #}
                                <div class="product-detail-tax-container">
                                    {% if context.taxState == "gross" %}
                                        {% set taxText = "general.grossTaxInformation"|trans|sw_sanitize %}
                                    {% else %}
                                        {% set taxText = "general.netTaxInformation"|trans|sw_sanitize %}
                                    {% endif %}

                                    <p class="product-detail-tax">
                                        {% block page_product_detail_tax_link %}
                                            <a class="product-detail-tax-link"
                                               href="{{ path('frontend.cms.page',{ id: config('core.basicInformation.shippingPaymentInfoPage') }) }}"
                                               title="{{ taxText }}"
                                               data-bs-toggle="modal"
                                               data-url="{{ path('frontend.cms.page',{ id: config('core.basicInformation.shippingPaymentInfoPage') }) }}">
                                                {{ taxText }}
                                            </a>
                                        {% endblock %}
                                    </p>
                                </div>
                            {% endblock %}
                        </div>
                    {% endif %}
                    {% block page_product_detail_price %}
                        {# the block page_product_detail_price was moved from product-detail/buy-widget.html.twig #}
                        <div class="product-detail-price-container {% if page.product.calculatedPrices|length > 1 %}product-detail-price-table{% endif %}">
                            {% sw_include '@Storefront/storefront/page/product-detail/buy-widget-price.html.twig' %}
                        </div>
                    {% endblock %}

                    {% block page_product_detail_configurator_include %}
                        {% if page.product.parentId and page.configuratorSettings|length > 0 %}
                            <form></form>
                            <div class="product-detail-configurator-container">
                                {% sw_include '@Storefront/storefront/page/product-detail/configurator.html.twig' %}
                            </div>
                        {% endif %}
                    {% endblock %}
                </div>
            {% endblock %}

            {{ block('page_product_detail_buy_redirect_input') }}

            {{ block('page_product_detail_buy_product_buy_info') }}

            {{ block('page_product_detail_product_buy_meta') }}

            {% block page_product_detail_product_customized_products %}
                {% sw_include '@Storefront/storefront/component/buy-widget/buy-widget-form-customized-products.html.twig' ignore missing %}
            {% endblock %}

            {% block page_product_detail_buy_button_container %}
                <div class="col-10">
                    {% block page_product_detail_buy_button %}
                        <div class="d-grid">
                            <button class="btn btn-primary btn-buy"
                                    title="{{ "detail.addProduct"|trans|striptags }}"
                                    aria-label="{{ "detail.addProduct"|trans|striptags }}">
                                {% sw_icon 'ic-cart' style {'pack' : 'cinema'} %}
                                {{ "detail.addProduct"|trans|sw_sanitize }}
                            </button>
                        </div>
                    {% endblock %}
                </div>
                <div class="col-2">
                    {% if config('core.cart.wishlistEnabled') %}
                        {% block page_product_detail_wishlist %}
                            {% sw_include '@Storefront/storefront/component/product/card/wishlist.html.twig' with {
                                showText: true,
                                size: 'md',
                                productId: page.product.id
                            } %}
                        {% endblock %}
                    {% endif %}
                </div>

                <div class="col-10 product-payment-logo">
                    {% if page.extensions.payPalEcsButtonData or page.extensions.payPalInstallmentBannerData is not null %}
                        {% block page_product_detail_buy_container_paypal %}
                            {{ parent() }}
                        {% endblock %}
                    {% endif %}

                    {% block page_product_detail_buy_container_amazon %}
                        {% if buyable and page.extensions.SwagAmazonPayButton is not null %}
                            {% block page_product_detail_buy_container_swag_amazon_pay_button %}
                                {{ parent() }}
                            {% endblock %}
                        {% endif %}
                    {% endblock %}
                </div>
            {% endblock %}
        </div>
    {% endif %}
{% endblock %}
