{% sw_extends '@Storefront/storefront/component/address/address-form.html.twig' %}

{% block component_address_form_zipcode_city %}
    {% set zipcodeField %}
    {% set zipcodeValue = formViolations.getInputData()['zipcode'] ?? data.get('zipcode') %}
        {% if formViolations.getViolations("/zipcode") is not empty %}
            {% set violationPath = "/zipcode" %}
        {% elseif formViolations.getViolations("/#{prefix}/zipcode") is not empty %}
            {% set violationPath = "/#{prefix}/zipcode" %}
        {% else %}
            {% set requiredMessage = "error.VIOLATION::IS_BLANK_ERROR"|trans({ '%field%': "address.zipcodeLabel"|trans|sw_sanitize }) %}
        {% endif %}

        {{ block('component_address_form_zipcode_label') }}

        {{ block('component_address_form_zipcode_input') }}

        {{ block('component_address_form_zipcode_error') }}
    {% endset %}

    {% set cityField %}
        {% if formViolations.getViolations("/city") is not empty %}
            {% set violationPath = "/city" %}
        {% elseif formViolations.getViolations("/#{prefix}/city") is not empty %}
            {% set violationPath = "/#{prefix}/city" %}
        {% else %}
            {% set requiredMessage = "error.VIOLATION::IS_BLANK_ERROR"|trans({ '%field%': "address.cityLabel"|trans|sw_sanitize }) %}
            {% set violationPath = null %}
        {% endif %}

        {{ block('component_address_form_city_label') }}

        {{ block('component_address_form_city_input') }}

        {{ block('component_address_form_city_error') }}
    {% endset %}

    {% if config('core.address.showZipcodeInFrontOfCity') %}
        <div class="form-group col-12 col-md-4 col-lg-6">
            {{ zipcodeField }}
        </div>

        <div class="form-group col-12 col-md-8 col-lg-6">
            {{ cityField }}
        </div>
    {% else %}
        <div class="form-group col-12 col-md-8 col-lg-6">
            {{ cityField }}
        </div>

        <div class="form-group col-12 col-md-4 col-lg-6">
            {{ zipcodeField }}
        </div>
    {% endif %}
{% endblock %}

{% block component_address_form_street %}
    <div class="form-group col-12">
        {% if formViolations.getViolations("/street") is not empty %}
            {% set violationPath = "/street" %}
        {% elseif formViolations.getViolations("/#{prefix}/street") is not empty %}
            {% set violationPath = "/#{prefix}/street" %}
        {% else %}
            {% set requiredMessage = "error.VIOLATION::IS_BLANK_ERROR"|trans({ '%field%': "address.streetLabel"|trans|sw_sanitize }) %}
        {% endif %}

        {{ block('component_address_form_street_label') }}

        {{ block('component_address_form_street_input') }}

        {{ block('component_address_form_street_input_error') }}
    </div>
{% endblock %}

{% block component_address_form_country %}
    <div class="form-group col-12 col-lg-6" data-custom-select="true">
        {% set initialCountryId = null %}

        {% if data.get('countryId') %}
            {% set initialCountryId = data.get('countryId') %}
        {% elseif page.countries|length == 1 %}
            {% set initialCountryId = (page.countries|first).id %}
        {% endif %}

        {% if formViolations.getViolations("/countryId") is not empty %}
            {% set violationPath = "/countryId" %}
        {% elseif formViolations.getViolations("/#{prefix}/countryId") is not empty %}
            {% set violationPath = "/#{prefix}/countryId" %}
        {% endif %}

        {{ block ('component_address_form_country_label') }}

        {{ block ('component_address_form_country_select') }}
    </div>

    <div class="form-group col-md-6 d-none" data-custom-select="true">
        {% if formViolations.getViolations("/countryStateId") is not empty %}
            {% set violationPath = "/countryStateId" %}
        {% elseif formViolations.getViolations("/#{prefix}/countryStateId") is not empty %}
            {% set violationPath = "/#{prefix}/countryStateId" %}
        {% endif %}

        {{ block ('component_address_form_country_state_label') }}

        {{ block('component_address_form_country_state_select') }}

        {{ block('component_address_form_country_error') }}
    </div>
{% endblock %}
